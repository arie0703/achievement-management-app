# 実装計画

- [x] 1. プロジェクト構造とコアインターフェースの設定
  - Go モジュールの初期化とディレクトリ構造の作成
  - 基本的なデータモデル（Achievement、Reward、CurrentPoints、RewardHistory）の定義
  - サービスとリポジトリのインターフェース定義
  - _要件: 1.1, 2.1, 3.1, 4.1_

- [x] 2. DynamoDB接続とリポジトリ層の実装
  - [x] 2.1 DynamoDB クライアントとリポジトリ基盤の実装
    - AWS SDK for Go v2を使用したDynamoDBクライアントの設定
    - 基本的なCRUD操作を提供するリポジトリインターフェースの実装
    - エラーハンドリングとリトライロジックの実装
    - _要件: 8.1, 8.2, 8.4_

  - [x] 2.2 達成目録リポジトリの実装
    - achievementsテーブルに対するCRUD操作の実装
    - データ変換ロジック（Go構造体 ↔ DynamoDB属性）の実装
    - ユニットテストの作成
    - _要件: 1.1, 1.4_

  - [x] 2.3 報酬リポジトリの実装
    - rewardsテーブルに対するCRUD操作の実装
    - データ変換ロジックの実装
    - ユニットテストの作成
    - _要件: 2.1, 2.4_

  - [x] 2.4 ポイント管理リポジトリの実装
    - current_pointsテーブルとreward_historyテーブルの操作実装
    - トランザクション処理の実装（ポイント更新と履歴記録）
    - ユニットテストの作成
    - _要件: 3.1, 3.3, 4.1, 4.5_

- [-] 3. ビジネスロジック層の実装
  - [x] 3.1 達成目録サービスの実装
    - 達成目録の作成、更新、取得、削除機能の実装
    - バリデーションロジック（タイトル必須、ポイント正数）の実装
    - 達成目録追加時のポイント自動加算機能の実装
    - ユニットテストの作成
    - _要件: 1.1, 1.2, 1.3, 3.1, 3.3_

  - [x] 3.2 報酬サービスの実装
    - 報酬の作成、更新、取得、削除機能の実装
    - バリデーションロジック（タイトル必須、ポイント正数）の実装
    - ユニットテストの作成
    - _要件: 2.1, 2.2, 2.3_

  - [x] 3.3 報酬獲得機能の実装
    - ポイント残高確認と報酬獲得処理の実装
    - トランザクション処理（ポイント減算と履歴記録）の実装
    - 不十分なポイントの場合のエラーハンドリング
    - ユニットテストの作成
    - _要件: 4.1, 4.2, 4.3, 4.4, 4.5_

  - [x] 3.4 ポイント集計サービスの実装
    - 全達成目録のポイント合計計算機能の実装
    - 現在のポイントとの比較・差異検出機能の実装
    - 集計結果の表示機能の実装
    - ユニットテストの作成
    - _要件: 5.1, 5.2, 5.3, 5.4_

- [ ] 4. REST API層の実装
  - [x] 4.1 HTTP サーバーとミドルウェアの設定
    - Gin フレームワークを使用したHTTPサーバーの設定
    - JSON レスポンス形式の統一
    - エラーハンドリングミドルウェアの実装
    - ログ出力ミドルウェアの実装
    - _要件: 6.1, 6.4_

  - [x] 4.2 達成目録APIエンドポイントの実装
    - POST /api/achievements（作成）の実装
    - GET /api/achievements（一覧取得）の実装
    - GET /api/achievements/{id}（詳細取得）の実装
    - PUT /api/achievements/{id}（更新）の実装
    - DELETE /api/achievements/{id}（削除）の実装
    - リクエストバリデーションとエラーレスポンスの実装
    - _要件: 1.1, 1.2, 1.3, 1.4, 6.1, 6.2, 6.3_

  - [x] 4.3 報酬APIエンドポイントの実装
    - POST /api/rewards（作成）の実装
    - GET /api/rewards（一覧取得）の実装
    - GET /api/rewards/{id}（詳細取得）の実装
    - PUT /api/rewards/{id}（更新）の実装
    - DELETE /api/rewards/{id}（削除）の実装
    - POST /api/rewards/{id}/redeem（獲得）の実装
    - リクエストバリデーションとエラーレスポンスの実装
    - _要件: 2.1, 2.2, 2.3, 2.4, 4.1, 4.2, 4.3, 4.4, 6.1, 6.2, 6.3_

  - [x] 4.4 ポイント管理APIエンドポイントの実装
    - GET /api/points/current（現在のポイント取得）の実装
    - GET /api/points/aggregate（ポイント集計）の実装
    - GET /api/points/history（報酬獲得履歴取得）の実装
    - エラーレスポンスの実装
    - _要件: 3.2, 5.1, 5.2, 5.3, 5.4, 9.3, 6.1, 6.3_

- [x] 5. CLI ツールの実装
  - [x] 5.1 CLI フレームワークとコマンド構造の設定
    - Cobra ライブラリを使用したCLIアプリケーションの基盤実装
    - 共通フラグ（設定ファイル、ログレベル等）の設定
    - ヘルプテキストとUsage情報の実装
    - _要件: 7.1_

  - [x] 5.2 達成目録管理コマンドの実装
    - achievement create コマンドの実装
    - achievement list コマンドの実装
    - achievement update コマンドの実装
    - achievement delete コマンドの実装
    - コマンド実行結果の表示とエラーハンドリング
    - _要件: 1.1, 1.2, 1.4, 7.1, 7.2, 7.3, 7.4_

  - [x] 5.3 報酬管理コマンドの実装
    - reward create コマンドの実装
    - reward list コマンドの実装
    - reward update コマンドの実装
    - reward redeem コマンドの実装
    - reward delete コマンドの実装
    - コマンド実行結果の表示とエラーハンドリング
    - _要件: 2.1, 2.2, 2.4, 4.1, 4.2, 4.3, 7.1, 7.2, 7.3, 7.4_

  - [x] 5.4 ポイント管理コマンドの実装
    - points current コマンドの実装
    - points aggregate コマンドの実装
    - points history コマンドの実装
    - 集計結果の見やすい表示形式の実装
    - _要件: 3.2, 5.1, 5.2, 5.3, 5.4, 9.3, 7.1, 7.2, 7.4_

- [ ] 6. 統合テストの実装
  - [ ] 6.1 DynamoDB統合テストの実装
    - DynamoDB Localを使用したテスト環境の設定
    - リポジトリ層の統合テスト実装
    - テストデータのセットアップ・クリーンアップ処理
    - _要件: 8.1, 8.2_

  - [ ] 6.2 API統合テストの実装
    - HTTPテストサーバーを使用したAPI統合テスト
    - 各エンドポイントの正常系・異常系テスト
    - レスポンス形式とステータスコードの検証
    - _要件: 6.1, 6.2, 6.3_

  - [ ] 6.3 CLI統合テストの実装
    - CLIコマンドの統合テスト実装
    - コマンド出力とエラーメッセージの検証
    - 実際のDynamoDBとの連携テスト
    - _要件: 7.1, 7.2, 7.3_

- [ ] 7. 設定管理とデプロイメント準備
  - [x] 7.1 設定ファイルと環境変数の実装
    - AWS認証情報とDynamoDBエンドポイントの設定
    - 環境別設定ファイル（開発、本番）の作成
    - 設定値のバリデーション機能の実装
    - _要件: 8.1_

  - [x] 7.2 ログ機能の実装
    - 構造化ログ（JSON形式）の実装
    - ログレベル設定とフィルタリング機能
    - エラーログとアクセスログの分離
    - _要件: 6.4_

  - [x] 7.3 ビルドとパッケージング
    - Makefileまたはビルドスクリプトの作成
    - バイナリファイルの生成とクロスコンパイル設定
    - Dockerイメージの作成（オプション）
    - _要件: 全般_

- [ ] 8. ドキュメントとE2Eテスト
  - [ ] 8.1 API ドキュメントの作成
    - OpenAPI/Swagger仕様書の作成
    - エンドポイント仕様とサンプルレスポンスの記述
    - エラーコード一覧の作成
    - _要件: 6.1, 6.2, 6.3_

  - [ ] 8.2 E2Eテストシナリオの実装
    - 完全なワークフロー（達成目録追加→ポイント蓄積→報酬獲得）のテスト
    - エラーシナリオ（ポイント不足、存在しないリソース等）のテスト
    - パフォーマンステストの基本実装
    - _要件: 全般_

  - [ ] 8.3 README とセットアップガイドの作成
    - プロジェクト概要と機能説明
    - 開発環境のセットアップ手順
    - API使用例とCLIコマンド例
    - トラブルシューティングガイド
    - _要件: 全般_